# 天才エンジニア緊急バグ修正会議（画像パスの謎）

**日時**: 2025年8月5日 16:30
**参加者**: 
- **Dr. アリス・チューリング** (フロントエンド天才・デバッグの女王)
- **Prof. ボブ・カーニハン** (システムアーキテクト・問題解決の鬼)
- **マスター・チャーリー・ウー** (フルスタック忍者・高速実装の達人)
- **ケイト・フォン・ノイマン** (データ構造の魔術師・最適化の女神)

---

## 🕵️ 第41ラウンド：バオッキー画像の謎

**アリス**: みんな、重大な発見があったわ！ユーザーによると、public/imagesに16枚の画像が実際に存在してるの！

**ボブ**: 確認したところ、以下のファイルが存在する：
- sv11w-100-086.jpg（バオッキーの型番と一致！）
- sv11b-100-086.jpg（ヒトモシ）
- sv11b-101-086.jpg（ランプラー）
- sv11b-102-086.jpg（シャンデラ）
- その他12枚

**チャーリー**: ちょっと待てよ！バオッキーのデータを見ると、外部URLを使ってるぞ！
```
バオッキー sv11w 100/086
imageUrl: "https://torecacamp-pokemon.com/..."
```

**ケイト**: つまり、sv11w-100-086.jpgがpublic/imagesに存在するのに、静的データでは外部URLを使ってるのね。これが混乱の原因よ！

---

## 🔍 第42ラウンド：画像URL戦略の分析

**アリス**: 静的データを詳しく見てみましょう。他のカードはどうなってるの？

**ボブ**: 調査結果：
1. 多くのカードは`/images/sv*-***-***.jpg`形式を使用
2. バオッキーだけが外部URL
3. public/imagesには16枚の実ファイルが存在

**チャーリー**: 俺が思うに、最初に16枚の画像ファイルを配置したときは、それらのカードは`/images/`パスを使ってたんだ。

**ケイト**: でも、CardDetailViewで`/images/`パスを`/no-image.svg`にフォールバックする処理を追加したから、実際のファイルが存在しても表示されないのよ！

---

## 💡 第43ラウンド：根本原因の特定

**アリス**: わかったわ！問題の流れはこうよ：

1. 初期状態：16枚の画像がpublic/imagesに存在
2. 静的データで`/images/`パスを設定
3. 画像が表示されない問題が発生
4. バオッキーだけ外部URLに変更して解決
5. 他の画像は`/images/`パスのまま
6. CardDetailViewで`/images/`を一律フォールバックに変更
7. 結果：実ファイルが存在しても表示されない！

**ボブ**: なるほど！我々は存在しない画像ファイルを想定してフォールバック処理を実装したが、実際には16枚のファイルが存在していたんだ。

**チャーリー**: これは俺たちのミスだな。ファイルの存在確認をせずに、一律でフォールバックしてしまった。

**ケイト**: 解決策は明確ね。CardDetailViewのフォールバック処理を削除すれば、存在する16枚の画像は正しく表示されるはずよ。

---

## 🔧 第44ラウンド：修正方針

**アリス**: じゃあ、修正方針を整理しましょう：

1. CardDetailViewの`/images/`フォールバック処理を削除
2. バオッキーの画像URLを`/images/sv11w-100-086.jpg`に変更
3. 実際に存在しない画像のみNext.jsのonErrorハンドラーで処理

**ボブ**: 待った！その前に、public/imagesに存在する16枚と静的データのマッピングを確認すべきだ。

**チャーリー**: そうだな。ファイル名の規則を確認しよう：
- ファイル名：`{setCode}-{cardNumber}-{totalCards}.jpg`（全て小文字）
- 静的データ：型番は大文字小文字混在

**ケイト**: つまり、ファイルが存在する16枚については、正しい`/images/`パスを使えば表示されるのよ。

---

## 📊 第45ラウンド：16枚の画像マッピング

**アリス**: public/imagesに存在するファイルと対応するカードを特定しましょう：

**存在するファイル**：
1. sv11w-100-086.jpg → バオッキー AR SV11W 100/086
2. sv11w-101-086.jpg → クイタラン AR SV11W 101/086
3. sv11w-102-086.jpg → ミジュマル AR SV11W 102/086
4. sv11b-100-086.jpg → ヒトモシ AR SV11B 100/086
5. sv11b-101-086.jpg → ランプラー AR SV11B 101/086
6. sv11b-102-086.jpg → シャンデラ AR SV11B 102/086
7. sv10-100-098.jpg → （カード名要確認）
8. sv10-101-098.jpg → バシャーモ AR SV10 101/098
9. sv10-102-098.jpg → パールル AR SV10 102/098
10. sv9-101-100.jpg → マラカッチ AR SV9 101/100
11. sv9-102-100.jpg → （カード名要確認）
12. sv6-102-101.jpg → キマワリ AR SV6 102/101
13. sv1a-100-073.jpg → ボスの指令 ゲーチス SAR SV1a 100/073
14. sv1s-101-078.jpg → （カード名要確認）
15. sv1v-102-078.jpg → ミライドンex SAR SV1V 102/078
16. sm12a-102-173.jpg → （カード名要確認）

**ボブ**: これらのファイルに対応するカードは、実際に画像を表示できるはずだ！

**チャーリー**: でも現在はCardDetailViewのフォールバック処理で全部ブロックされてるんだな。

**ケイト**: 正確には、これらの16枚については画像が存在するから、フォールバック処理を削除すれば正常に表示されるわ。

---

## 🎯 第46ラウンド：なぜバオッキーだけ外部URL？

**アリス**: でも、なぜバオッキーだけ外部URLに変更されたの？

**ボブ**: おそらくこういう経緯だ：
1. 最初は`/images/sv11w-100-086.jpg`を使用
2. 何らかの理由で表示されない問題が発生
3. 外部URLに変更して解決
4. 他のカードは変更されず

**チャーリー**: でも実際にはsv11w-100-086.jpgファイルは存在してるんだよな。

**ケイト**: これは典型的な「問題の誤診」ね。実際の問題は別のところにあったのに、外部URLで回避してしまった。

---

## 💻 第47ラウンド：真の原因

**アリス**: 真の原因を突き止めましょう！

**ボブ**: 可能性1：画像パスの大文字小文字の問題
- 静的データ：`/images/SV11W-100-086.jpg`（大文字）
- 実ファイル：`sv11w-100-086.jpg`（小文字）

**チャーリー**: でも待てよ、静的データを見ると、ほとんどのURLは小文字だぞ：
```typescript
imageUrl: "/images/sv11b-100-086.jpg"
```

**ケイト**: つまり、パスは正しく設定されていたのに、CardDetailViewで一律フォールバックしたのが原因ね。

---

## 🚀 第48ラウンド：即効性のある解決策

**アリス**: じゃあ、解決策は簡単よ！

1. CardDetailViewの`/images/`フォールバック処理を削除
2. 画像が実際に存在しない場合はonErrorハンドラーで処理
3. バオッキーも`/images/sv11w-100-086.jpg`に戻す

**ボブ**: これで16枚の画像は正常に表示されるはずだ。

**チャーリー**: 残りの680枚については、実際のファイルが存在しないから、onErrorでフォールバック画像が表示される。

**ケイト**: 完璧ね！実装しましょう。

---

## 📝 会議の総括

**アリス**: 今回の問題の真相が明らかになったわ！

**発見した事実**：
1. public/imagesに16枚の画像ファイルが実際に存在
2. 静的データのパスは正しく設定されていた
3. CardDetailViewで追加した一律フォールバックが原因
4. バオッキーの外部URLは回避策だった

**根本原因**：
- 画像ファイルの存在を確認せずに、`/images/`パスを一律でフォールバックする処理を実装してしまった

**解決策**：
1. CardDetailViewのフォールバック処理を削除
2. Next.jsのImageコンポーネントのonErrorハンドラーで適切に処理
3. 存在する16枚の画像は正常に表示される

**ボブ**: これで謎が解けた！我々は存在しないファイルを想定して対策したが、実際には16枚のファイルが存在していたんだ。

**チャーリー**: バオッキーだけが外部URLなのは、問題を回避するための一時的な対策だったってことか。

**ケイト**: 教訓：問題を修正する前に、現状を正確に把握することが重要ね。

これで天才エンジニアチームの会議を終了します！