# 改修仕様書0218_1

## 1. 概要
納品書画面において、システムに登録されていない商品を手動で追加する機能を追加する。

## 2. 背景
現状のシステムでは、Googleスプレッドシートに登録された商品データのみを納品書に追加できる。しかし、スプレッドシートのデータ不備や、未登録の商品を急遽追加したい場合に、対応ができない。
先日発生した「ガルーラ AR SV10 110/098」のデータ不整合のようなケースに対応するため、納品書作成時に手動で項目を追加できる柔軟性を持たせる必要がある。

## 3. 仕様詳細

### 3.1. UI変更点

#### 3.1.1. 納品書画面 (`/invoice`)
- 納品書一覧の下部に「手動で商品を追加」ボタンを新規に設置する。

#### 3.1.2. 商品追加フォーム
- 「手動で商品を追加」ボタンをクリックすると、モーダルウィンドウまたはアコーディオン形式で入力フォームが表示される。
- フォームには以下の入力フィールドを設ける。
  - **商品タイトル**: `テキスト入力` (必須)
  - **商品型番**: `テキスト入力` (任意)
  - **レアリティ**: `テキスト入力` (任意)
  - **買取価格**: `数値入力` (必須、円単位)
  - **数量**: `数値入力` (必須、デフォルト値: 1)
- フォーム内には、「追加」ボタンと「キャンセル」ボタンを設置する。

### 3.2. 機能要件

- **項目追加**:
  - 「追加」ボタンをクリックすると、フォームに入力された内容が納品書の一覧に新しい項目として追加される。
  - 追加された項目は、他の項目と同様に納品書一覧に表示される。
  - 項目の追加後、納品書の合計金額が自動で再計算される。
- **データ管理**:
  - 手動で追加されたデータは、そのセッションの納品書にのみ反映される。データベースや元のスプレッドシートには保存されない。
- **入力バリデーション**:
  - `商品タイトル`、`買取価格`、`数量`は必須項目とする。未入力の場合はエラーメッセージを表示し、追加処理は行わない。
  - `買取価格`と`数量`には、0以上の数値のみが入力できるようにする。
- **キャンセル**:
  - 「キャンセル」ボタンをクリックすると、入力内容が破棄され、フォームが閉じる。

## 4. 改修対象の主要ファイル（想定）
- `app/invoice/page.tsx`
- `contexts/InvoiceContext.tsx`
- `components/InvoiceView.tsx`
- (新規作成) `components/ManualAddForm.tsx` 